<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Chore Adventure</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Comic Sans MS', cursive; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 10px; }
        .container { max-width: 1200px; margin: 0 auto; background: rgba(255, 255, 255, 0.95); border-radius: 20px; padding: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
        .header { text-align: center; margin-bottom: 30px; }
        .title { font-size: 2.5em; color: #4a5568; margin-bottom: 10px; animation: glow 2s ease-in-out infinite alternate; }
        @keyframes glow { from { text-shadow: 2px 2px 4px rgba(0,0,0,0.1), 0 0 10px rgba(255,215,0,0.3); } to { text-shadow: 2px 2px 4px rgba(0,0,0,0.1), 0 0 20px rgba(255,215,0,0.6); } }
        .subtitle { font-size: 1.2em; color: #718096; }
        .game-modes { display: flex; gap: 20px; margin-bottom: 30px; justify-content: center; flex-wrap: wrap; }
        .mode-btn { padding: 15px 30px; border: none; border-radius: 15px; font-size: 1.1em; font-weight: bold; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .mode-btn.active { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(0,0,0,0.2); }
        .parent-mode { background: linear-gradient(45deg, #ff6b6b, #feca57); color: white; }
        .child1-mode { background: linear-gradient(45deg, #1e3c72, #2a5298); color: white; }
        .child2-mode { background: linear-gradient(45deg, #ff9a9e, #fecfef); color: #333; }
        .player-section { display: none; animation: fadeIn 0.5s ease-in; }
        .player-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .adventure-map { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 20px; padding: 30px; margin-bottom: 30px; text-align: center; color: white; position: relative; overflow: hidden; }
        .character-avatar { width: 120px; height: 120px; border-radius: 50%; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; font-size: 4em; background: rgba(255,255,255,0.2); border: 3px solid rgba(255,255,255,0.3); animation: bounce 2s ease-in-out infinite; }
        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .progress-bar-container { background: rgba(255,255,255,0.2); border-radius: 10px; padding: 15px; margin: 20px 0; backdrop-filter: blur(10px); }
        .progress-bar { background: rgba(255,255,255,0.3); height: 20px; border-radius: 10px; overflow: hidden; }
        .progress-fill { height: 100%; background: linear-gradient(90deg, #ffd700, #ffed4e); border-radius: 10px; transition: width 0.5s ease; position: relative; }
        .quest-board { background: rgba(255,255,255,0.95); border-radius: 20px; padding: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); position: relative; }
        .quest-title { font-size: 1.8em; color: #4a5568; margin-bottom: 20px; }
        .quest-item { background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%); border-radius: 15px; padding: 20px; margin-bottom: 15px; border-left: 5px solid; transition: all 0.3s ease; position: relative; overflow: hidden; }
        .quest-item:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.15); }
        .daily-quest { border-left-color: #48bb78; }
        .weekly-quest { border-left-color: #ed8936; }
        .monthly-quest { border-left-color: #9f7aea; }
        .quest-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
        .quest-name { font-size: 1.2em; font-weight: bold; color: #2d3748; }
        .quest-difficulty { color: #ffd700; font-size: 1.2em; }
        .quest-reward { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; color: #4a5568; }
        .reward-coins { background: linear-gradient(45deg, #ffd700, #ffed4e); color: #333; padding: 5px 12px; border-radius: 20px; font-weight: bold; font-size: 0.9em; }
        .quest-actions { display: flex; gap: 10px; align-items: center; }
        .action-btn { padding: 12px 24px; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; transition: all 0.3s ease; position: relative; overflow: hidden; }
        .start-quest { background: linear-gradient(45deg, #4299e1, #3182ce); color: white; }
        .complete-quest { background: linear-gradient(45deg, #48bb78, #38a169); color: white; }
        .quest-status { display: flex; align-items: center; gap: 10px; font-weight: bold; }
        .status-pending { color: #ed8936; animation: pulse 2s infinite; }
        .status-completed { color: #48bb78; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .admin-section { background: #f7fafc; padding: 20px; border-radius: 15px; margin-bottom: 20px; }
        .admin-title { font-size: 1.3em; font-weight: bold; margin-bottom: 15px; color: #4a5568; }
        .input-group { display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; }
        .input-group input, .input-group select { padding: 10px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 1em; }
        .add-btn { background: #4299e1; color: white; padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
        .delete-btn { background: #e53e3e; color: white; padding: 5px 10px; border: none; border-radius: 5px; cursor: pointer; font-size: 0.8em; }
        .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; justify-content: center; align-items: center; z-index: 1000; }
        .modal-content { background: white; border-radius: 20px; padding: 30px; max-width: 500px; width: 90%; text-align: center; position: relative; }
        .modal-title { font-size: 2em; margin-bottom: 20px; color: #4a5568; }
        .modal-input { padding: 15px; font-size: 1.2em; border: 3px solid #e2e8f0; border-radius: 10px; text-align: center; width: 100%; margin-bottom: 20px; }
        .modal-btn { background: linear-gradient(45deg, #4299e1, #3182ce); color: white; padding: 15px 30px; border: none; border-radius: 10px; font-size: 1.1em; font-weight: bold; cursor: pointer; margin: 10px; transition: all 0.3s ease; }
        .celebration-popup { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; border-radius: 20px; text-align: center; box-shadow: 0 20px 40px rgba(0,0,0,0.3); z-index: 1001; display: none; }
        .celebration-popup.show { display: block; animation: celebrationBounce 0.6s ease-out; }
        @keyframes celebrationBounce { 0% { transform: translate(-50%, -50%) scale(0.3); opacity: 0; } 50% { transform: translate(-50%, -50%) scale(1.1); } 100% { transform: translate(-50%, -50%) scale(1); opacity: 1; } }
        .achievement-notification { position: fixed; top: 20px; right: 20px; background: linear-gradient(45deg, #48bb78, #38a169); color: white; padding: 15px 25px; border-radius: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); transform: translateX(400px); transition: transform 0.3s ease; z-index: 1002; }
        .achievement-notification.show { transform: translateX(0); }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="title">üåü Family Chore Adventure üåü</h1>
            <p class="subtitle">Embark on epic quests and become the ultimate chore champion!</p>
        </div>
        
        <div class="game-modes">
            <button class="mode-btn parent-mode" onclick="switchMode('parent')">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Quest Master</button>
            <button class="mode-btn child1-mode" onclick="switchMode('child1')">‚ö° Harry's Wizarding Academy</button>
            <button class="mode-btn child2-mode" onclick="switchMode('child2')">ü¶Ñ Princess Unicorn Kingdom</button>
        </div>
        
        <!-- Parent Mode -->
        <div id="parent-section" class="player-section">
            <div class="admin-section">
                <h2 class="admin-title">‚öôÔ∏è Quest Settings</h2>
                <div class="input-group">
                    <label>Stars needed for grand prize:</label>
                    <input type="number" id="starsTarget" value="10" min="1" max="50">
                    <button class="add-btn" onclick="updateStarsTarget()">Update</button>
                </div>
            </div>
            
            <div class="admin-section">
                <h2 class="admin-title">‚ûï Create New Quest</h2>
                <div class="input-group">
                    <input type="text" id="newChoreName" placeholder="Quest name (e.g., 'clean the drawers')">
                    <input type="number" id="newChorePoints" placeholder="Stars" min="1" max="10" value="1">
                    <select id="newChoreFreq">
                        <option value="daily">Daily Quest</option>
                        <option value="weekly">Weekly Quest</option>
                        <option value="monthly">Epic Quest</option>
                    </select>
                </div>
                <div class="input-group">
                    <label style="font-weight: bold; margin-right: 10px;">Assign to:</label>
                    <label style="margin-right: 15px;">
                        <input type="checkbox" id="assignChild1" checked> Harry (Wizard)
                    </label>
                    <label style="margin-right: 15px;">
                        <input type="checkbox" id="assignChild2" checked> Princess (Royal)
                    </label>
                </div>
                <button class="add-btn" onclick="addChore()">Create Quest</button>
                <div style="margin-top: 10px; font-size: 0.9em; color: #666; font-style: italic;">
                    üí° Tip: Chores reset daily/weekly/monthly with new challenges!
                </div>
            </div>
            
            <div class="admin-section">
                <h2 class="admin-title">üìã Quest Management</h2>
                <div id="admin-chores"></div>
            </div>
            
            <div class="admin-section">
                <h2 class="admin-title">‚úÖ Pending Quest Approvals</h2>
                <div id="pending-approvals"></div>
            </div>
        </div>
        
        <!-- Child 1 Mode -->
        <div id="child1-section" class="player-section">
            <div class="adventure-map">
                <div class="character-avatar">‚ö°</div>
                <div style="margin-bottom: 20px;">
                    <div style="font-size: 1.5em; font-weight: bold;">Level <span id="child1-level">1</span> Wizard</div>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="child1-progress-fill" style="width: 0%;"></div>
                    </div>
                    <div style="text-align: center; margin-top: 10px; font-weight: bold;">
                        <span id="child1-stars-display">0</span> / <span id="child1-target-display">10</span> Magic Stars ‚≠ê
                    </div>
                </div>
            </div>
            
            <div class="quest-board">
                <h2 class="quest-title">Available Quests</h2>
                <div id="child1-quests"></div>
            </div>
        </div>
        
        <!-- Child 2 Mode -->
        <div id="child2-section" class="player-section">
            <div class="adventure-map" style="background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);">
                <div class="character-avatar">ü¶Ñ</div>
                <div style="margin-bottom: 20px;">
                    <div style="font-size: 1.5em; font-weight: bold;">Level <span id="child2-level">1</span> Princess</div>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="child2-progress-fill" style="width: 0%; background: linear-gradient(90deg, #ff69b4, #ffc0cb);"></div>
                    </div>
                    <div style="text-align: center; margin-top: 10px; font-weight: bold;">
                        <span id="child2-stars-display">0</span> / <span id="child2-target-display">10</span> Royal Stars ‚≠ê
                    </div>
                </div>
            </div>
            
            <div class="quest-board">
                <h2 class="quest-title">Royal Quests</h2>
                <div id="child2-quests"></div>
            </div>
        </div>
    </div>
    
    <!-- Modal -->
    <div class="modal" id="gameModal">
        <div class="modal-content">
            <h2 class="modal-title" id="modalTitle">Challenge</h2>
            <div id="modalContent"></div>
        </div>
    </div>
    
    <!-- Celebration -->
    <div class="celebration-popup" id="celebrationPopup">
        <h2>üéâ QUEST COMPLETED! üéâ</h2>
        <p id="celebrationText"></p>
        <div style="font-size: 3em; margin: 20px 0;">‚ú®üåüüéä</div>
        <button class="modal-btn" onclick="closeCelebration()">Awesome!</button>
    </div>
    
    <!-- Notification -->
    <div class="achievement-notification" id="achievementNotification">
        <div id="achievementText"></div>
    </div>
    
    <script>
        var PARENT_PIN = "1234";
        var currentMode = 'child1';
        var nextChoreId = 6;
        var parentAuthenticated = false;
        
        var gameData = {
            starsTarget: 10,
            chores: [
                {id: 1, name: "Make bed", points: 2, frequency: "daily", assignedTo: ["child1", "child2"]},
                {id: 2, name: "Put away toys", points: 1, frequency: "daily", assignedTo: ["child1", "child2"]},
                {id: 3, name: "Clean room", points: 3, frequency: "weekly", assignedTo: ["child1", "child2"]},
                {id: 4, name: "Put away clothes", points: 2, frequency: "daily", assignedTo: ["child1", "child2"]},
                {id: 5, name: "Organise shoe cupboard", points: 4, frequency: "monthly", assignedTo: ["child1", "child2"]}
            ],
            players: {
                child1: {name: "Harry", stars: 0, level: 1, completedChores: [], pendingChores: [], activeQuests: [], lastResetDate: null},
                child2: {name: "Princess", stars: 0, level: 1, completedChores: [], pendingChores: [], activeQuests: [], lastResetDate: null}
            },
            lastResetCheck: null
        };
        
        var choreThemes = {
            child1: {
                keywords: {
                    'bed': 'magical dormitory bed',
                    'toys': 'magical artifacts',
                    'room': 'Hogwarts dormitory',
                    'clothes': 'wizard robes',
                    'drawers': 'magical storage chambers'
                },
                verbs: {
                    'make': 'enchant',
                    'clean': 'purify',
                    'organize': 'arrange magically'
                }
            },
            child2: {
                keywords: {
                    'bed': 'royal princess bed',
                    'toys': 'royal treasures',
                    'room': 'princess chambers',
                    'clothes': 'royal gowns',
                    'drawers': 'royal treasure drawers'
                },
                verbs: {
                    'make': 'prepare royally',
                    'clean': 'beautify',
                    'organize': 'arrange elegantly'
                }
            }
        };
        
        var challenges = {
            child1: {
                math: [
                    {question: "If you have 7 chocolate frogs and eat 3, then buy 5 more, how many do you have?", answer: "9"},
                    {question: "Hogwarts has 4 houses with 15 students each. How many students total?", answer: "60"},
                    {question: "A Quidditch match lasts 3 hours. How many minutes is that?", answer: "180"},
                    {question: "If a spell requires 12 ingredients and you have 8, how many more do you need?", answer: "4"},
                    {question: "Ron has 25 wizard cards. He gives 7 to Harry and 6 to Hermione. How many does he have left?", answer: "12"}
                ],
                riddles: [
                    {question: "I fly without wings, I see without eyes. I'm used in Quidditch, what am I?", answer: "SNITCH"},
                    {question: "Three heads I have, but one body. Fluffy am I, what creature could I be?", answer: "CERBERUS"},
                    {question: "I change my form but keep my mind, leaving my body far behind. What am I?", answer: "ANIMAGUS"},
                    {question: "I sort you into houses four, based on traits at your core. What am I?", answer: "HAT"},
                    {question: "I'm long and thin, made of wood. For casting spells, I'm very good. What am I?", answer: "WAND"}
                ]
            },
            child2: {
                spelling: [
                    {question: "Spell this magical word:", word: "LOVE", display: "L-O-V-E"},
                    {question: "Spell this royal word:", word: "ROSE", display: "R-O-S-E"},
                    {question: "Spell this pretty word:", word: "STAR", display: "S-T-A-R"},
                    {question: "Spell this sweet word:", word: "CAKE", display: "C-A-K-E"},
                    {question: "Spell this magical word:", word: "MOON", display: "M-O-O-N"}
                ],
                counting: [
                    {question: "Count the hearts: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è", answer: "3"},
                    {question: "Count the stars: ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê", answer: "5"},
                    {question: "Count the flowers: üå∏üå∏üå∏üå∏", answer: "4"},
                    {question: "Count the unicorns: ü¶Ñü¶Ñ", answer: "2"},
                    {question: "Count the crowns: üëëüëëüëëüëëüëëüëë", answer: "6"}
                ]
            }
        };
        
        function getThemedChoreName(originalName, childId) {
            if (!choreThemes[childId]) return originalName;
            var themedName = originalName.toLowerCase();
            var theme = choreThemes[childId];
            
            for (var keyword in theme.keywords) {
                var regex = new RegExp(keyword, 'gi');
                themedName = themedName.replace(regex, theme.keywords[keyword]);
            }
            
            for (var verb in theme.verbs) {
                var regex = new RegExp('\\b' + verb + '\\b', 'gi');
                themedName = themedName.replace(regex, theme.verbs[verb]);
            }
            
            return themedName.charAt(0).toUpperCase() + themedName.slice(1);
        }
        
        function checkAndResetChores() {
            var now = new Date();
            var today = now.toDateString();
            
            if (gameData.lastResetCheck !== today) {
                gameData.lastResetCheck = today;
                
                for (var child in gameData.players) {
                    var player = gameData.players[child];
                    var lastReset = player.lastResetDate ? new Date(player.lastResetDate) : new Date(0);
                    
                    if (lastReset.toDateString() !== today) {
                        resetChoresForPlayer(child, 'daily');
                        player.lastResetDate = today;
                    }
                }
                
                updateDisplay();
                saveGameData();
            }
        }
        
        function resetChoresForPlayer(child, frequency) {
            var player = gameData.players[child];
            var choresToReset = [];
            
            for (var i = 0; i < gameData.chores.length; i++) {
                var chore = gameData.chores[i];
                if (chore.frequency === frequency && chore.assignedTo && chore.assignedTo.indexOf(child) !== -1) {
                    choresToReset.push(chore);
                }
            }
            
            for (var j = 0; j < choresToReset.length; j++) {
                var choreId = choresToReset[j].id;
                player.completedChores = player.completedChores.filter(function(id) { return id !== choreId; });
                player.pendingChores = player.pendingChores.filter(function(id) { return id !== choreId; });
                player.activeQuests = player.activeQuests.filter(function(id) { return id !== choreId; });
            }
            
            if (choresToReset.length > 0) {
                showAchievement('Daily quests have reset for ' + player.name + '! üîÑ');
            }
        }
        
        function switchMode(mode) {
            if (mode === 'parent' && !parentAuthenticated) {
                showPINPrompt();
                return;
            }
            
            currentMode = mode;
            
            var buttons = document.querySelectorAll('.mode-btn');
            for (var i = 0; i < buttons.length; i++) {
                buttons[i].classList.remove('active');
            }
            document.querySelector('.' + mode + '-mode').classList.add('active');
            
            var sections = document.querySelectorAll('.player-section');
            for (var j = 0; j < sections.length; j++) {
                sections[j].classList.remove('active');
            }
            document.getElementById(mode + '-section').classList.add('active');
            
            updateDisplay();
        }
        
        function showPINPrompt() {
            var modal = document.getElementById('gameModal');
            var title = document.getElementById('modalTitle');
            var content = document.getElementById('modalContent');
            
            title.textContent = 'üîí Quest Master Access';
            content.innerHTML = '<p style="margin-bottom: 20px;">Enter the Quest Master PIN:</p><input type="password" class="modal-input" id="pinInput" placeholder="Enter PIN..." maxlength="10"><br><button class="modal-btn" onclick="checkPIN()">Enter</button><button class="modal-btn" onclick="closeModal()" style="background: #718096;">Cancel</button><div id="pin-feedback" style="margin-top: 15px; font-weight: bold;"></div>';
            
            modal.style.display = 'flex';
            setTimeout(function() {
                document.getElementById('pinInput').focus();
            }, 100);
        }
        
        function checkPIN() {
            var input = document.getElementById('pinInput');
            var feedback = document.getElementById('pin-feedback');
            
            if (input.value.trim() === PARENT_PIN) {
                parentAuthenticated = true;
                feedback.style.color = '#48bb78';
                feedback.textContent = '‚úÖ Access granted!';
                setTimeout(function() {
                    closeModal();
                    switchMode('parent');
                }, 1000);
            } else {
                feedback.style.color = '#e53e3e';
                feedback.textContent = '‚ùå Incorrect PIN. Try again.';
                input.value = '';
                input.focus();
            }
        }
        
        function updateDisplay() {
            checkAndResetChores();
            updatePlayerProgress();
            updateQuestDisplay();
            updateAdminDisplay();
            updatePendingApprovals();
        }
        
        function updatePlayerProgress() {
            for (var child in gameData.players) {
                var player = gameData.players[child];
                var progressFill = document.getElementById(child + '-progress-fill');
                var starsDisplay = document.getElementById(child + '-stars-display');
                var targetDisplay = document.getElementById(child + '-target-display');
                var levelDisplay = document.getElementById(child + '-level');
                
                if (progressFill) {
                    var progressPercent = (player.stars / gameData.starsTarget) * 100;
                    progressFill.style.width = Math.min(progressPercent, 100) + '%';
                }
                
                if (starsDisplay) starsDisplay.textContent = player.stars;
                if (targetDisplay) targetDisplay.textContent = gameData.starsTarget;
                if (levelDisplay) levelDisplay.textContent = player.level;
            }
        }
        
        function updateQuestDisplay() {
            for (var child in gameData.players) {
                var container = document.getElementById(child + '-quests');
                if (!container) continue;
                
                var player = gameData.players[child];
                var assignedChores = [];
                
                for (var i = 0; i < gameData.chores.length; i++) {
                    var chore = gameData.chores[i];
                    if (chore.assignedTo && chore.assignedTo.indexOf(child) !== -1) {
                        assignedChores.push(chore);
                    }
                }
                
                var html = '';
                for (var j = 0; j < assignedChores.length; j++) {
                    var chore = assignedChores[j];
                    var isActive = player.activeQuests.indexOf(chore.id) !== -1;
                    var isPending = player.pendingChores.indexOf(chore.id) !== -1;
                    var isCompleted = player.completedChores.indexOf(chore.id) !== -1;
                    
                    var statusHtml = '';
                    var actionHtml = '';
                    
                    if (isPending) {
                        statusHtml = '<div class="quest-status status-pending">üïê Awaiting approval</div>';
                        actionHtml = '';
                    } else if (isCompleted) {
                        statusHtml = '<div class="quest-status status-completed">‚úÖ Completed!</div>';
                        actionHtml = '';
                    } else if (isActive) {
                        statusHtml = '<div class="quest-status">üéØ In progress</div>';
                        actionHtml = '<button class="action-btn complete-quest" onclick="completeQuest(' + chore.id + ', \'' + child + '\')">Complete Quest!</button>';
                    } else {
                        statusHtml = '<div class="quest-status">üìú Available</div>';
                        actionHtml = '<button class="action-btn start-quest" onclick="startQuest(' + chore.id + ', \'' + child + '\')">Start Quest</button>';
                    }
